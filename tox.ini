[tox]
envlist = py310-localos, py310-dindos, py310-s2search
skipsdist = true

[testenv]
whitelist_externals =
  python
  bash
  docker
deps =
  pytest
  pillow
  numpy
  marqo
commands_pre =
  bash {toxinidir}{/}scripts{/}clone_marqo_repo.sh {toxinidir} mainline
commands_post =
  docker rm -f marqo
  docker rm -f marqo-os

[testenv:py310-localos]
setenv =
  TESTING_CONFIGURATION = LOCAL_MARQO_OS
  PYTHONPATH = {toxinidir}{/}tests{:}{toxinidir}
  PATH = {env:PATH}{:}{toxinidir}{/}scripts
commands =
  bash {toxinidir}{/}scripts{/}start_local_marqo_os.sh
  pytest tests/ {posargs}


[testenv:py310-dindos]
setenv =
  TESTING_CONFIGURATION = DIND_MARQO_OS
  PYTHONPATH = {toxinidir}{/}tests{:}{toxinidir}
  PATH = {env:PATH}{:}{toxinidir}{/}scripts
commands =
  bash {toxinidir}{/}scripts{/}start_dind_marqo_os.sh
  pytest tests/ {posargs}


[testenv:py310-s2search]
setenv =
  TESTING_CONFIGURATION = S2SEARCH_OS
  PYTHONPATH = {toxinidir}{/}tests{:}{toxinidir}
  PATH = {env:PATH}{:}{toxinidir}{/}scripts
commands =
  bash {toxinidir}{/}scripts{/}start_s2search_backend.sh
  pytest tests/ {posargs}
